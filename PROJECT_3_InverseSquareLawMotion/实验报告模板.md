# 项目：平方反比引力场中的运动 - 实验报告

**学生姓名：** 范玉洁]
**学号：** [20221050183]
**完成日期：** [6.4]

## 1. 实验目的

（请用1-2句话简要描述本次实验你希望达成的学习目标，例如：通过数值模拟研究不同能量和角动量条件下质点在平方反比引力场中的轨道特性，并验证能量守恒和角动量守恒。）
通过数值模拟研究不同能量和角动量条件下质点在平方反比引力场中的轨道特性，验证机械能和角动量守恒定律，并分析轨道形状与物理量的关系。
## 2. 核心算法与实现

### 2.1 运动方程与数值方法
（简要说明你所使用的运动方程（例如，直角坐标系下的二阶微分方程组）以及你选择的数值求解方法，如 `scipy.integrate.solve_ivp` 及其参数设置，或自行实现的算法如龙格-库塔法等。）
运动方程（直角坐标系）：\(\begin{cases}
\dot{x} = v_x, & \dot{y} = v_y \\
\dot{v}_x = -\frac{GMx}{r^3}, & \dot{v}_y = -\frac{GMy}{r^3}
\end{cases}\)其中 \(r = \sqrt{x^2 + y^2}\)。数值方法：使用 scipy.integrate.solve_ivp，选择高精度的 DOP853 算法，设置相对容差 rtol=1e-9、绝对容差 atol=1e-12，确保轨道积分的准确性。
### 2.2 关键函数实现思路
（选择1-2个你认为最核心的函数，例如 `derivatives` 或 `solve_orbit`，用3-5句话描述其实现思路和关键步骤。）
解包状态向量获取位置和速度，计算距离的立方时设置阈值（1e-10）避免除以零，根据运动方程计算加速度分量。
#### `[函数名1]` 实现思路：

```python
# derivatives 函数核心代码
x, y, vx, vy = state_vector
r_squared = x**2 + y**2
r_cubed = r_squared ** 1.5 if r_squared > 1e-10 else 1e-15  # 避免除零
ax = -gm_val * x / r_cubed
ay = -gm_val * y / r_cubed
return np.array([vx, vy, ax, ay])
```

#### `[函数名2]` 实现思路：

```python
# solve_orbit 函数核心代码
solution = solve_ivp(
    fun=derivatives,
    t_span=t_span,
    y0=initial_conditions,
    t_eval=t_eval,
    args=(gm_val,),
    method='DOP853',
    rtol=1e-9,
    atol=1e-12
)
return solution
```

## 3. 实验结果与分析

### 3.1 不同总能量下的轨道

（在此处展示并分析你针对任务 A 生成的轨道图像。确保图像清晰，包含必要的标签和图例。）
![image](https://github.com/user-attachments/assets/7aa0f34e-2393-4bac-bc97-98058ba0fd4f)
![屏幕截图 2025-06-04 113540](https://github.com/user-attachments/assets/843df777-ce1f-463b-8972-aad84e4cb7f2)

**图1：不同能量下的轨道图 (E<0, E=0, E>0)**

```
图像显示三种能量条件下的轨道：  
- 椭圆轨道 (E ≈ -0.1800)：闭合曲线，中心天体位于焦点，偏心率约0.6。  
- 抛物线轨道 (E ≈ 0.0000)：开口向右的抛物线，质点最终逃逸。  
- 双曲线轨道 (E ≈ 0.6250)：开口双曲线，质点快速远离中心天体。  
中心天体位于原点，轨道关于x轴对称。  
图像文件名：energy_orbits.png  
```

**结果分析：**
E < 0：轨道为椭圆（束缚态），质点绕中心天体周期性运动。
E = 0：轨道为抛物线，质点恰好逃逸，速度随距离趋于零。
E > 0：轨道为双曲线，质点逃逸后仍有剩余速度，轨道渐近线明确。

**(可选) 能量与角动量守恒验证：**
计算表明，三种轨道的机械能在数值误差范围内保持恒定（椭圆轨道能量波动约 \(1e-8\)），验证了能量守恒。角动量同样守恒，因平方反比力为有心力，力矩为零。
### 3.2 不同角动量下的椭圆轨道 (E < 0)

（在此处展示并分析你针对任务 B 生成的轨道图像。）
![屏幕截图 2025-06-04 113622](https://github.com/user-attachments/assets/e2e8b78b-2b71-43fe-bc2f-7b2c5d37a47a)

**图2：固定能量 (E=[具体值])，不同角动量下的椭圆轨道**

```
图像显示能量固定时，三种角动量对应的椭圆轨道：  
- L1 = 0.7000：偏心率较大，轨道“扁平”，近心点和远心点差异明显。  
- L2 = 0.8000：偏心率减小，轨道更接近圆形。  
- L3 = 0.9000：近圆形轨道，偏心率接近0。  
图像文件名：angular_momentum_orbits.png  
```

**结果分析：**
角动量越大，椭圆轨道的偏心率越小（\(e = \sqrt{1 + \frac{2EL^2}{G^2M^2m}}\)）。当角动量趋近于最大值时，轨道趋近于圆形；角动量减小时，轨道逐渐 “压扁”，近心点距离减小，远心点距离增大。

## 4. 问题与收获

### 4.1遇到的主要问题及解决方法
（列出你在完成项目中遇到的1-2个主要困难或挑战，并说明你是如何思考和解决这些问题的。）

问题 1： 初始条件设置错误导致轨道不闭合（如椭圆轨道变为螺旋线）。解决方法： 检查初始速度是否满足椭圆轨道条件（\(v < \sqrt{2GM/r}\)），通过计算逃逸速度公式 \(v_{\text{esc}} = \sqrt{2GM/r}\) 重新设置合理初速度。
问题 2： 计算 r 时出现除以零错误。解决方法： 在代码中添加阈值判断，当 \(r < 1e-10\) 时，将 r 设为极小值（如 \(1e-10\)），避免数值不稳定。
### 4.2 主要收获与体会
深入理解了平方反比力场中能量和角动量对轨道形状的决定性作用，验证了开普勒轨道理论。
掌握了数值求解常微分方程（ODE）的方法，学会使用 solve_ivp 处理物理问题中的高精度需求。

## 5. (可选) 思考与展望

（如果你完成了可选任务或有其他深入思考，可以在此部分阐述。）

### 5.1 坐标转换与对称性
（如果你研究了极坐标转换和轨道对称性，请在此处分享你的发现和理解。）
若转换为极坐标（\(r, \theta\)），运动方程可简化为径向和角向方程，更便于分析轨道的径向振荡和角位移关系。轨道对称性（如关于初始速度方向对称）源于平方反比力的中心力性质，角动量守恒保证轨道位于固定平面内。
### 5.2 其他思考
（例如，此模型有哪些局限性？如何可以进一步扩展或改进这个项目？真实天体运动与此理想模型的差异等。）
局限性： 模型假设中心天体静止且忽略其他引力源，真实天体运动需考虑双星系统或多体摄动。
改进方向： 扩展模型至三维空间或多体问题，引入相对论修正（如史瓦西轨道），或研究有阻力介质中的轨道衰减现象。
实际应用： 该模型可用于卫星轨道设计、行星际探测器轨迹规划，帮助理解彗星（抛物线 / 双曲线轨道）和行星（椭圆轨道）的运动规律。
